<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mare's Cakes & Pastries — WhatsApp Orders (Single File)</title>
<meta name="description" content="Order banana bread & cake loaves from Mare's Cakes & Pastries. Send your order summary directly to WhatsApp—no online payment required."/>
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='30' fill='%23ffb703'/%3E%3Ctext x='32' y='40' font-size='32' text-anchor='middle' fill='%235f1d2d' font-family='Arial'%3EM%3C/text%3E%3C/svg%3E"/>
<style>
:root{
  --brand:#5f1d2d;
  --accent:#ffb703;
  --bg:#fffaf5;
  --border:#e5e5e5;
}
*{box-sizing:border-box}
html,body{margin:0}
body{font-family:system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, 'Helvetica Neue', Arial, 'Apple Color Emoji','Segoe UI Emoji'; background:var(--bg); color:#222}
.container{max-width:1100px;margin:0 auto;padding:16px}
header.sticky{position:sticky;top:0;backdrop-filter:saturate(140%) blur(6px);background:rgba(255,255,255,.75);border-bottom:1px solid var(--border);z-index:50}
.header-inner{display:flex;align-items:center;justify-content:space-between;padding:10px 16px}
.brand{display:flex;align-items:center;gap:10px}
.brand-logo{width:40px;height:40px;border-radius:10px;background:rgba(255,183,3,.15);display:grid;place-items:center;overflow:hidden;border:1px solid var(--border)}
.brand-logo img{max-width:34px;max-height:34px;object-fit:contain}
.brand-text{line-height:1}
.brand-title{font-weight:800;color:var(--brand)}
.brand-tag{font-size:12px;color:#666}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 14px;border-radius:12px;border:1px solid var(--border);background:#fff;cursor:pointer}
.btn.primary{background:var(--brand);border-color:var(--brand);color:#fff}
.btn:disabled{opacity:.6;cursor:not-allowed}
.grid{display:grid;gap:16px}
@media(min-width:1024px){ .grid-3{grid-template-columns:2fr 1fr;} }
.card{background:#fff;border:1px solid var(--border);border-radius:16px;box-shadow:0 1px 0 rgba(0,0,0,.03);padding:16px}
.card h2{margin:0 0 10px;font-size:18px}
.row{display:flex;align-items:center;gap:12px}
.item{display:flex;align-items:center;gap:12px;padding:12px 0;border-top:1px dashed #eee}
.item:first-child{border-top:none}
.thumb{width:76px;height:76px;border-radius:12px;border:1px solid var(--border);overflow:hidden;background:#f4f4f5;flex-shrink:0}
.thumb img{width:100%;height:100%;object-fit:cover}
.item-meta{flex:1;min-width:0}
.item-name{font-weight:600}
.item-group{font-size:12px;color:#666;margin-top:2px}
.badge{font-size:10px;border:1px solid #ddd;border-radius:999px;padding:2px 6px}
.pills{display:flex;gap:6px;flex-wrap:wrap;margin-top:6px}
.pill{font-size:12px;border:1px solid #ddd;border-radius:10px;padding:4px 8px;background:#fff;cursor:pointer}
.pill.active{border-color:#111;font-weight:700}
.qty{display:inline-flex;align-items:center;border:1px solid #ddd;border-radius:10px;overflow:hidden}
.qty button{border:0;background:#fafafa;padding:6px 10px;cursor:pointer}
.qty input{width:54px;text-align:center;padding:6px;border:0}
.label{font-size:13px;color:#555;margin-bottom:4px}
.input, select{width:100%;padding:10px 12px;border:1px solid #ddd;border-radius:12px;background:#fff}
.small{font-size:12px;color:#666}
.summary .row{justify-content:space-between}
.summary .total{font-weight:800;font-size:18px}
hr{border:0;border-top:1px solid #eee;margin:8px 0}
.sticky-mobile{position:fixed;bottom:0;left:0;right:0;background:rgba(255,255,255,.95);backdrop-filter:blur(6px);border-top:1px solid var(--border);padding:10px;display:flex;align-items:center;gap:10px}
.sheet{position:fixed;inset:0;display:none}
.sheet.show{display:block}
.sheet .backdrop{position:absolute;inset:0;background:rgba(0,0,0,.45)}
.sheet .panel{position:absolute;left:0;right:0;bottom:0;background:#fff;border-top-left-radius:18px;border-top-right-radius:18px;padding:16px;max-height:75vh;overflow:auto}
.alert{padding:10px 12px;border-radius:12px;border:1px solid #f2d6d6;background:#fff2f2;color:#7a1a1a;font-size:12px}
.notice{padding:10px 12px;border-radius:12px;border:1px solid #d1fadf;background:#ecfdf5;color:#065f46;font-size:12px}
.privacy{font-size:12px;color:#555}
a.link{color:#2563eb;text-decoration:underline}
</style>
</head>
<body>
<header class="sticky">
  <div class="header-inner container">
    <div class="brand">
      <div class="brand-logo">
        <img alt="Mare's logo" src="https://res.cloudinary.com/dvl40rhin/image/upload/v1759081580/MARE_LOGO_ONLY_sjojzh.png"/>
      </div>
      <div class="brand-text">
        <div class="brand-title">Mare's Cakes &amp; Pastries</div>
        <div class="brand-tag">Each bite will make you say MARE-Y me.</div>
      </div>
    </div>
    <a class="btn primary" href="#order">Order Now</a>
  </div>
</header>

<main class="container grid grid-3" id="order" style="padding-bottom:90px">
  <section class="card notice" style="grid-column:1/-1">
    <b>Delivery days:</b> Tuesdays and Fridays. Please order <b>at least one day before</b> these days to receive your order.
  </section>
  <section class="card">
    <h2>Menu <span class="small">• choose size, then set qty</span></h2>
    <div id="menu"></div>
  </section>

  <section class="card summary">
    <h2>Summary</h2>
    <div class="row"><span>Subtotal</span><span id="subtotalN">₦0</span></div>
    <div class="row total"><span>Total</span><span id="totalN">₦0</span></div>
    <div style="margin-top:10px">
      <button id="sendBtn" class="btn primary" style="width:100%">Send Order via WhatsApp</button>
      <p class="small">A WhatsApp chat will open with your full order summary. You can confirm and arrange payment there.</p>
      <div id="miniWarning" class="alert" style="display:none"></div>
    </div>
  </section>

  <section class="card" style="grid-column:1/-1">
    <h2>Customer</h2>
    <div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px">
      <div>
        <div class="label">Full Name</div>
        <input id="name" class="input" />
      </div>
      <div>
        <div class="label">Phone</div>
        <input id="phone" class="input" />
      </div>
      <div>
        <div class="label">Email</div>
        <input id="email" type="email" class="input" />
      </div>
      <div>
        <div class="label">Gender</div>
        <select id="gender">
          <option value="">Select gender</option>
          <option>Female</option>
          <option>Male</option>
          <option>Prefer not to say</option>
        </select>
      </div>
      <div style="grid-column:1/-1">
        <div class="label">Delivery Location / Address</div>
        <input id="delivery" class="input" placeholder="e.g., Yaba, Lagos — 24 Ajose Street" />
      </div>
      <label class="privacy" style="grid-column:1/-1;display:flex;gap:8px;align-items:flex-start">
        <input id="consent" type="checkbox" style="margin-top:4px"/>
        <span>I consent to the <a href="#" id="openPrivacy" class="link">Privacy Policy</a> and agree my personal data will be used for <b>order fulfilment</b> and <b>analytics only</b>.</span>
      </label>
    </div>
  </section>
</main>

<!-- Sticky mobile bar -->
<div class="sticky-mobile" id="mobileBar">
  <div style="flex:1">
    <div class="small">Total (incl. VAT)</div>
    <div id="mobileTotal" style="font-weight:700">₦0</div>
  </div>
  <button id="sendBtnMobile" class="btn primary">Send</button>
</div>

<!-- Privacy modal -->
<div class="sheet" id="privacySheet" aria-hidden="true">
  <div class="backdrop" data-close="sheet"></div>
  <div class="panel">
    <div class="row" style="justify-content:space-between">
      <div style="font-weight:700">Privacy Policy</div>
      <button class="btn" data-close="sheet">✕</button>
    </div>
    <div style="margin-top:8px">
      <p>We collect and process your <b>personal data</b> (name, phone, email, gender, and delivery address) solely to:</p>
      <ul>
        <li>Fulfil and support your order (invoicing, delivery, customer support).</li>
        <li>Run basic, privacy-aware <b>analytics</b> to improve our products and service.</li>
      </ul>
      <p>We do <b>not</b> sell or share your personal data with third parties for marketing. Data may be retained as required by law and accounting rules.</p>
      <p class="small">By placing an order, you consent to the processing of your personal data as described here.</p>
    </div>
  </div>
</div>

<!-- WhatsApp backup sheet -->
<div class="sheet" id="waSheet" aria-hidden="true">
  <div class="backdrop" data-close="sheet"></div>
  <div class="panel">
    <div class="row" style="justify-content:space-between">
      <div style="font-weight:700">Order Ready to Send</div>
      <button class="btn" data-close="sheet">✕</button>
    </div>
    <p class="small">Tap the button below to send your order to WhatsApp. If a tab already opened, this is a backup.</p>
    <div id="waItems" class="card" style="padding:12px"></div>
    <a id="waLink" class="btn primary" style="width:100%;margin-top:8px" target="_blank" rel="noopener">Open WhatsApp &amp; Send Order</a>
  </div>
</div>

<script>
// ====== CONFIG ======
const BRAND = { name: "Mare's Cakes & Pastries" };
const BUSINESS = { whatsappPhone: "2349065307788" };
// Optional webhook (no-cors) — keep as empty string to disable
const WEBHOOK_URL = "https://script.google.com/macros/s/AKfycbwuNDLgTA1vWNZResox1KW88B1YZ_ksbd-P8Oki01y0tDnxXpriIFIXA2D5YFjTk4DR/exec";

const SIZES = ["Mini","Medium","Regular"];
const ITEMS = [
  {id:"bb_classic", group:"Banana Bread", name:"Classic Banana Bread", img:"https://res.cloudinary.com/dvl40rhin/image/upload/v1759079789/Classic_Banana_Bread_apwoe3.jpg", variants:{ Mini:1500, Medium:5500, Regular:8000 }},
  {id:"bb_raisins", group:"Banana Bread", name:"Raisins Banana Bread", img:"https://res.cloudinary.com/dvl40rhin/image/upload/v1759079885/Raisins_Banana_Bread_y8dyxt.jpg", variants:{ Mini:1700, Medium:6000, Regular:8800 }},
  {id:"bb_choco", group:"Banana Bread", name:"Chocolate Banana Bread", img:"https://res.cloudinary.com/dvl40rhin/image/upload/v1759079973/chocolate_banana_bread_ybedbi.jpg", variants:{ Mini:1700, Medium:5000, Regular:8400 }},
  {id:"bb_nutty", group:"Banana Bread", name:"Nutty Banana Bread", img:"https://res.cloudinary.com/dvl40rhin/image/upload/v1759080017/Nutty_Banana_Bread_xe61cb.jpg", variants:{ Mini:2400, Medium:7600, Regular:10300 }},
  {id:"bb_classic_ganache", group:"Banana Bread", name:"Classic × Ganache Banana Bread", img:"https://res.cloudinary.com/dvl40rhin/image/upload/v1759080095/Classic_Ganache_Banana_Bread_mhgqqq.jpg", variants:{ Mini:1700, Medium:6000, Regular:8800 }},
  {id:"bb_choc_chips", group:"Banana Bread", name:"Chocolate Chips Banana Bread", img:"https://res.cloudinary.com/dvl40rhin/image/upload/v1759080154/Chocolate_Chips_Banana_Bread_begokb.jpg", variants:{ Mini:1700, Medium:6000, Regular:8400 }},
  {id:"bb_coconut", group:"Banana Bread", name:"Coconut Banana Bread", img:"https://res.cloudinary.com/dvl40rhin/image/upload/v1759080217/Coconut_Banana_Bread_vjop89.jpg", variants:{ Mini:1800, Medium:6200, Regular:9000 }},
  {id:"bb_oreo_choc", group:"Banana Bread", name:"Oreo × Chocolate Chips Banana Bread", img:"https://res.cloudinary.com/dvl40rhin/image/upload/v1759080265/Oreo_Chocolate_Chips_Banana_Bread_u4b0fq.jpg", variants:{ Mini:2300, Medium:7500, Regular:8000 }},
  {id:"bb_oreo_delight", group:"Banana Bread", name:"Oreo Delight Banana Bread", img:"https://res.cloudinary.com/dvl40rhin/image/upload/v1759080328/Oreo_Delight_Banana_Bread_d3sa3n.jpg", variants:{ Mini:2000, Medium:6500, Regular:9000 }},
  {id:"bb_baileys", group:"Banana Bread", name:"Baileys Banana Bread", img:"https://res.cloudinary.com/dvl40rhin/image/upload/v1759080402/Baileys_Banana_Bread_eqdbsw.jpg", variants:{ Mini:1900, Medium:6600, Regular:9000 }},
  {id:"bb_baileys_coco", group:"Banana Bread", name:"Baileys × Coconut Banana Bread", img:"https://res.cloudinary.com/dvl40rhin/image/upload/v1759080449/Baileys_Coconut_Banana_Bread_pa0xoz.jpg", variants:{ Mini:2500, Medium:8000, Regular:10500 }},
  {id:"bb_coco_choc_chips", group:"Banana Bread", name:"Coconut × Chocolate Chips Banana Bread", img:"https://res.cloudinary.com/dvl40rhin/image/upload/v1759080449/Baileys_Coconut_Banana_Bread_pa0xoz.jpg", variants:{ Mini:1900, Medium:6200, Regular:8400 }},
  {id:"cl_choc", group:"Cake Loaf", name:"Chocolate Cake Loaf", img:"https://res.cloudinary.com/dvl40rhin/image/upload/v1759080618/Chocolate_Cake_Loaf_gl8vbi.jpg", variants:{ Mini:2000, Medium:4800, Regular:8200 }},
  {id:"cl_redvelvet", group:"Cake Loaf", name:"Red Velvet Cake Loaf", img:"https://res.cloudinary.com/dvl40rhin/image/upload/v1759080697/Red_Velvet_Cake_Loaf_aripvz.jpg", variants:{ Mini:2200, Medium:5000, Regular:8500 }},
  {id:"cl_darkchoc", group:"Cake Loaf", name:"Dark Chocolate Cake Loaf", img:"https://res.cloudinary.com/dvl40rhin/image/upload/v1759080759/Dark_Chocolate_Cake_Loaf_wt5o85.jpg", variants:{ Mini:2400, Medium:5500, Regular:9000 }},
  {id:"cl_carrot", group:"Cake Loaf", name:"Carrot Cake Loaf", img:"https://res.cloudinary.com/dvl40rhin/image/upload/v1759080848/Carrot_Cake_Loaf_rovgf7.jpg", variants:{ Mini:null, Medium:5500, Regular:8400 }},
];

// ====== STATE ======
const state = {
  cart: {}, // key: `${id}__${size}` => { name, price, qty }
  selectedSize: {}, // id => size
  form: { name:"", phone:"", email:"", gender:"", delivery:"", consent:false },
  wa: { visible:false, link:"", items:[], subtotal:0, vat:0, total:0 },
};

function N(n){ n = n||0; return "₦" + (Math.round(n*100)/100).toLocaleString("en-NG"); }
function defaultSize(item){ return ["Mini","Medium","Regular"].find(s => item.variants[s]); }
function activeSize(item){ return state.selectedSize[item.id] || defaultSize(item); }
function priceOf(item, size){ return item.variants[size] || 0; }
function cartKey(item, size){ return item.id + "__" + size; }
function cartName(item, size){ return item.name + " (" + size + ")"; }

function setQty(item, size, q){
  const key = cartKey(item, size);
  const entry = q>0 ? { name: cartName(item, size), price: priceOf(item, size), qty:q } : null;
  if (entry) state.cart[key] = entry; else delete state.cart[key];
  // Re-render menu so the Minis badge updates across items
  renderMenu();
  maybeShowMiniWarning();
}

function setSize(item, size){
  state.selectedSize[item.id] = size;
  renderMenu(); // to refresh qty row text
}

function subtotal(){ return Object.values(state.cart).reduce((s,e)=>s+(e.price||0)*(e.qty||0),0); }
function vat(){ return 0; }
function total(){ return subtotal()+vat(); }

function totalMiniQty(){
  return Object.entries(state.cart).reduce((sum,[k,e])=>k.endsWith("__Mini")? sum+(e.qty||0):sum,0);
}
function hasNonMini(){
  return Object.keys(state.cart).some(k=>!k.endsWith("__Mini"));
}
function miniOnlyInsufficient(){
  const tm = totalMiniQty();
  return tm>0 && !hasNonMini() && tm<4;
}

function maybeShowMiniWarning(){
  const warn = document.getElementById("miniWarning");
  if (!hasNonMini() && totalMiniQty()>0 && totalMiniQty()<4){
    warn.style.display = "block";
    warn.textContent = "Minimum order for Minis is 4 if ordering minis only. You currently have " + totalMiniQty() + ". Add " + (4-totalMiniQty()) + " more.";
  } else {
    warn.style.display = "none";
    warn.textContent = "";
  }
}

function renderMenu(){
  const root = document.getElementById("menu");
  root.innerHTML = "";
  ITEMS.forEach(item=>{
    const size = activeSize(item);
    const key = cartKey(item, size);
    const qty = (state.cart[key]?.qty)||0;

    const row = document.createElement("div");
    row.className = "item";

    const thumb = document.createElement("div");
    thumb.className = "thumb";
    thumb.innerHTML = item.img ? `<img alt="${item.name}"/>` : "<div style='display:grid;place-items:center;height:100%;color:#aaa;font-size:12px'>No Image</div>";
    if (item.img) { thumb.querySelector("img").src = item.img; }
    row.appendChild(thumb);

    const meta = document.createElement("div");
    meta.className = "item-meta";
    meta.innerHTML = `<div class="item-name">${item.name}</div><div class="item-group">${item.group}</div>`;

    const pills = document.createElement("div");
    pills.className = "pills";
    SIZES.forEach(sz=>{
      const available = !!item.variants[sz];
      const pill = document.createElement("button");
      pill.type = "button";
      pill.className = "pill" + (size===sz ? " active" : "");
      pill.textContent = sz;
      pill.disabled = !available;
      pill.style.opacity = available ? "1" : ".4";
      pill.onclick = () => setSize(item, sz);
      pills.appendChild(pill);
    });
    // Minis badge
    if (item.variants.Mini){
      const badge = document.createElement("span");
      const ok = hasNonMini() || totalMiniQty()>=4;
      const count = Math.min(totalMiniQty(),4);
      badge.className = "badge";
      badge.textContent = "Minis: " + count + "/4";
      badge.style.background = ok ? "#ecfdf5" : "#fff2f2";
      badge.style.borderColor = ok ? "#bbf7d0" : "#fecaca";
      badge.style.color = ok ? "#065f46" : "#7f1d1d";
      pills.appendChild(badge);
    }
    meta.appendChild(pills);
    row.appendChild(meta);

    const right = document.createElement("div");
    right.className = "row";
    right.style.gap = "8px";
    const priceEl = document.createElement("div");
    priceEl.style.width = "90px";
    priceEl.style.textAlign = "right";
    priceEl.style.fontWeight = "700";
    priceEl.textContent = N(priceOf(item, size));
    right.appendChild(priceEl);

    const qtyBox = document.createElement("div");
    qtyBox.className = "qty";
    const minus = document.createElement("button");
    minus.textContent = "−";
    minus.onclick = ()=> setQty(item, size, Math.max(0, qty-1));
    const input = document.createElement("input");
    input.type = "number"; input.min = "0"; input.value = qty;
    input.onchange = () => setQty(item, size, Math.max(0, Number(input.value||0)));
    const plus = document.createElement("button");
    plus.textContent = "＋";
    plus.onclick = ()=> setQty(item, size, qty+1);
    qtyBox.append(minus, input, plus);
    right.appendChild(qtyBox);

    row.appendChild(right);
    root.appendChild(row);
  });
  renderSummary(); // update totals and mobile
}

function renderSummary(){
  document.getElementById("subtotalN").textContent = N(subtotal());
    document.getElementById("totalN").textContent = N(total());
  document.getElementById("mobileTotal").textContent = N(total());
}

function getForm(){
  return {
    name: document.getElementById("name").value.trim(),
    phone: document.getElementById("phone").value.trim(),
    email: document.getElementById("email").value.trim(),
    gender: document.getElementById("gender").value,
    delivery: document.getElementById("delivery").value.trim(),
    consent: document.getElementById("consent").checked,
  };
}

function buildWhatsAppText(){
  const f = getForm();
  const lines = [
    "*New Order — " + BRAND.name + "*",
    "Name: " + f.name,
    "Phone: " + f.phone,
    f.email ? "Email: " + f.email : null,
    f.gender ? "Gender: " + f.gender : null,
    f.delivery ? "Delivery Location: " + f.delivery : null,
    "",
    "*Items*",
    ...Object.values(state.cart).map(e => "- " + e.name + " x" + e.qty + " = " + N((e.price||0)*(e.qty||0))),
    "",
    "*Subtotal:* " + N(subtotal()),
    "*Total:* " + N(total()),
  ].filter(Boolean);
  return encodeURIComponent(lines.join("\n"));
}

function buildWhatsAppLink(){
  const text = buildWhatsAppText();
  const phone = BUSINESS.whatsappPhone;
  // api.whatsapp.com works across devices; wa.me also fine
  return "https://wa.me/" + phone + "?text=" + text;
}

function sendToWebhook(payload){
  try{
    if (!WEBHOOK_URL) return;
    if (navigator.sendBeacon){
      const blob = new Blob([JSON.stringify(payload)], {type:'text/plain;charset=utf-8'});
      navigator.sendBeacon(WEBHOOK_URL, blob);
    }else{
      fetch(WEBHOOK_URL, {method:'POST', headers:{'Content-Type':'text/plain;charset=utf-8'}, body:JSON.stringify(payload), mode:'no-cors', keepalive:true});
    }
  }catch(e){ console.warn("Webhook failed", e); }
}

function openSheet(id, show){
  const el = document.getElementById(id);
  if (!el) return;
  el.className = "sheet" + (show ? " show" : "");
  el.setAttribute("aria-hidden", show ? "false" : "true");
}

function handleSend(){
  const f = getForm();
  if (!f.consent) return alert("Please consent to the Privacy Policy before sending.");
  if (!f.name || !f.phone || !f.email || !f.gender || !f.delivery) return alert("Please fill Name, Phone, Email, Gender, Delivery.");
  if (Object.keys(state.cart).length===0) return alert("Your cart is empty.");
  if (miniOnlyInsufficient()) return alert("Minimum order for Minis is 4 if ordering minis only.");

  const items = Object.values(state.cart).map(e=>({ name: e.name, qty:e.qty, unit_price:e.price, line_total:(e.price||0)*(e.qty||0) }));
  const payload = {
    provider:'whatsapp',
    payment_ref:null,
    currency:'NGN',
    totals:{ subtotal:subtotal(), vat:vat(), total:total() },
    customer:{ ...f, consent:true },
    items,
    business:{ name:BRAND.name },
    created_at: new Date().toISOString(),
  };
  sendToWebhook(payload);

  const link = buildWhatsAppLink();
  // Try to open in a new tab immediately (pop-up blockers)
  let w = null;
  try{ w = window.open(link, "_blank"); }catch(e){ w=null; }
  // Show backup sheet
  const list = document.getElementById("waItems");
  list.innerHTML = `<div class="row" style="justify-content:space-between"><b>Subtotal</b><span>${N(subtotal())}</span></div>
                    <div class="row" style="justify-content:space-between"><b>Total</b><span>${N(total())}</span></div>
                    <hr/>` + items.map(it=>`<div class="row" style="justify-content:space-between"><span>${it.name} ×${it.qty}</span><span>${N(it.line_total)}</span></div>`).join("");
  const a = document.getElementById("waLink");
  a.href = link;
  openSheet("waSheet", true);
}

function init(){
  // Close sheets
  document.addEventListener("click", (e)=>{
    const t = e.target;
    if (t.dataset && t.dataset.close === "sheet") {
      openSheet("privacySheet", false);
      openSheet("waSheet", false);
    }
  });
  document.getElementById("openPrivacy").addEventListener("click", (e)=>{
    e.preventDefault();
    openSheet("privacySheet", true);
  });

  document.getElementById("sendBtn").addEventListener("click", handleSend);
  document.getElementById("sendBtnMobile").addEventListener("click", handleSend);

  // Auto-close WA sheet when page hidden (common after WA opens)
  document.addEventListener("visibilitychange", ()=>{
    if (document.visibilityState === "hidden") openSheet("waSheet", false);
  });

  // Render
  renderMenu();
  maybeShowMiniWarning();
}
if (document.readyState === "loading") document.addEventListener("DOMContentLoaded", init); else init();
</script>
</body>
</html>
